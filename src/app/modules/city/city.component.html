<h1 class="title">Cities weather</h1>
<article class="panel is-primary">
  <div class="panel-heading"><h2>{{cityName$ | async}}</h2></div>
  <div class="panel-block">
    <app-l-map zoom="13" *ngIf="cityCoords$ | async as coords" [lat]="coords.latitude" [long]="coords.longitude"></app-l-map>
  </div>
  <div class="panel-block">
    <div class="control">
      <label for="celcius" class="radio">
        <input id="celcius" type="radio" name="degree" value="C" [(ngModel)]="degree" aria-controls="weather">
        C°
      </label>
      <label for="fahrenheit" class="radio">
        <input id="fahrenheit" type="radio" name="degree" value="F" [(ngModel)]="degree" aria-controls="weather">
        F°
      </label>
    </div>
    <div class="control">
      <label for="simple" class="radio">
        <input id="simple" type="radio" name="mode" value="simple" [(ngModel)]="mode" aria-controls="weather">
        Simple
      </label>
      <label for="detailed" class="radio">
        <input id="detailed" type="radio" name="mode" value="detailed" [(ngModel)]="mode" aria-controls="weather">
        Detailed
      </label>
    </div>
  </div>
  <div id="weather" role="region" aria-live="polite">
  <ng-container *ngIf="mode === 'simple'">
    <div class="panel-block" *ngIf="cityWeather$ | async as cityWeather; else loading">
      <table class="table is-flex-grow-1">
        <tr>
          <th scope="col">Date</th>
          <th scope="col">Weather</th>
          <th scope="col">Max</th>
          <th scope="col">Min</th>
        </tr>
        <tr *ngFor="let weather of cityWeather">
          <td>{{weather.date | dateFormat}}</td>
          <td><img [src]="'http://www.7timer.info/img/misc/about_civil_'+weather.weather+'.png'" [alt]="weather.weather"></td>
          <td>{{weather.temp2m.max | degree: degree}}</td>
          <td>{{weather.temp2m.min | degree: degree}}</td>
        </tr>
      </table>
    </div>
  </ng-container>
  <ng-container *ngIf="mode === 'detailed'">
    <div class="panel-block" *ngIf="cityWeatherDetailed$ | async as cityWeather; else loading">
      <table class="table is-flex-grow-1">
        <tr>
          <th>Date</th>
          <th>Weather</th>
          <th>Temp</th>
        </tr>
        <tr *ngFor="let weather of cityWeather">
          <td>{{weather.timepoint}}h from now</td>
          <td><img [src]="'http://www.7timer.info/img/misc/about_civil_' + weather.weather + '.png'" alt={weather.weather}></td>
          <td>{{weather.temp2m | degree: degree}}</td>
        </tr>
      </table>
    </div>
  </ng-container>
  <ng-template #loading>
    <div class="panel-block">Loading...</div>
  </ng-template>
  </div>
  <div class="panel-block">
    <a routerLink="/" class="button is-rounded">
      Go back home
    </a>
  </div>
</article>
